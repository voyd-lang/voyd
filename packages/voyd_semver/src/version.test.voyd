use std::test::assertions::all
use std::string::type::new_string

test "string init parses strict versions":
  match(Version("1.2.3"))
    Some { value: version }:
      assert(version.major, eq: 1)
      assert(version.minor, eq: 2)
      assert(version.patch, eq: 3)
    None:
      assert(false)

test "bump helpers increment and reset segments":
  let version = Version(1, 2, 3)

  let major = version.bump_major()
  assert(major.major, eq: 2)
  assert(major.minor, eq: 0)
  assert(major.patch, eq: 0)

  let minor = version.bump_minor()
  assert(minor.major, eq: 1)
  assert(minor.minor, eq: 3)
  assert(minor.patch, eq: 0)

  let patch = version.bump_patch()
  assert(patch.major, eq: 1)
  assert(patch.minor, eq: 2)
  assert(patch.patch, eq: 4)

test "compare and relation helpers follow precedence":
  let v_123 = Version(1, 2, 3)
  let v_124 = Version(1, 2, 4)
  let v_130 = Version(1, 3, 0)
  let v_200 = Version(2, 0, 0)

  assert(v_123.compare(v_124), eq: -1)
  assert(v_124.compare(v_123), eq: 1)
  assert(v_123.compare(v_123), eq: 0)

  assert(v_123 < v_124)
  assert(v_123 <= v_123)
  assert(v_200 > v_130)
  assert(v_124 >= v_123)
  assert(v_123 == Version(1, 2, 3))
