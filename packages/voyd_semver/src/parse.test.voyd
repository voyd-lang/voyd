use std::test::assertions::all

test "parse accepts strict major minor patch":
  match(parse("0.0.0"))
    Some { value }:
      assert(value.major, eq: 0)
      assert(value.minor, eq: 0)
      assert(value.patch, eq: 0)
    None:
      assert(false)

  match(parse("1.2.3"))
    Some { value }:
      assert(value.major, eq: 1)
      assert(value.minor, eq: 2)
      assert(value.patch, eq: 3)
    None:
      assert(false)

  match(parse("10.20.30"))
    Some { value }:
      assert(value.major, eq: 10)
      assert(value.minor, eq: 20)
      assert(value.patch, eq: 30)
    None:
      assert(false)

test "parse rejects invalid versions":
  match(parse("1"))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("1.2"))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("1.2.3.4"))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("1.2."))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("1..2"))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("v1.2.3"))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("01.2.3"))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("1.02.3"))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("1.2.03"))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("1.2.-1"))
    Some:
      assert(false)
    None:
      assert(true)
  match(parse("1.2.a"))
    Some:
      assert(false)
    None:
      assert(true)
