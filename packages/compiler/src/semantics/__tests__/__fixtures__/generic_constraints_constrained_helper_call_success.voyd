trait Key<T>
  fn same(self, other: T) -> bool

obj IntKey {
  value: i32
}

impl Key<IntKey> for IntKey
  fn same(self, other: IntKey) -> bool
    self.value == other.value

obj Box<K, V> {
  value: V
}

fn wrap<K: Key<K>, V>(value: V) -> Box<K, V>
  Box<K, V> { value: value }

impl<K: Key<K>, V> Box<K, V>
  fn map<U>(self, value: U) -> Box<K, U>
    wrap<K, U>(value)

fn main() -> i32
  let box = Box<IntKey, i32> { value: 1 }
  let next = box.map<bool>(true)
  if next.value then: 1 else: 0
